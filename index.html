<!DOCTYPE html>
<html>
<head>
  <title>AR.js Rettangolo indipendente dal Marker</title>
  <!-- Libreria A-Frame -->
  <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
  <!-- Libreria AR.js -->
  <script src="https://raw.githack.com/AR-js-org/AR.js/3.4.5/aframe/build/aframe-ar.js"></script>

  <style>
    .message {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      padding: 12px 18px;
      background-color: rgba(0,0,0,0.5);
      color: white;
      font-family: Arial, sans-serif;
      border-radius: 10px;
      z-index: 9999;
      user-select: none;
    }
  </style>
</head>

<body style="margin: 0; overflow: hidden;">

  <div id="info" class="message">Inquadra il marker...</div>

  <a-scene embedded arjs="trackingMethod: marker;">
    <!-- Marker Hiro -->
    <a-marker preset="hiro" id="hiroMarker">
    </a-marker>

    <!-- Rettangolo indipendente (inizialmente nascosto) -->
    <a-plane 
      id="menuPanel"
      position="0 1 -3" 
      rotation="-45 0 0" 
      width="2" 
      height="1"
      color="#7BC8A4"
      visible="false">
    </a-plane>

    <a-entity camera></a-entity>
  </a-scene>

  <script>
    const marker = document.querySelector("#hiroMarker");
    const info = document.getElementById("info");
    const menuPanel = document.querySelector("#menuPanel");
    let isMarkerDetected = false;

    marker.addEventListener("markerFound", () => {
      info.innerText = "Marker rilevato!";
      if (!isMarkerDetected) {
        // Quando il marker viene rilevato per la prima volta, rendi visibile il rettangolo
        menuPanel.setAttribute("visible", true);
        isMarkerDetected = true;
      }
    });

    marker.addEventListener("markerLost", () => {
      info.innerText = "Marker perso, ma il pannello rimane visibile.";
      // NON NASCONDERE il pannello, resta sempre visibile dopo la prima rilevazione
    });
  </script>

</body>
</html>
